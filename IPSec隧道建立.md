# IPSec隧道建立

## 密钥交换

- **带外共享**
  - 通信双方通过一张磁盘，一张纸或一个电话等方式实现密钥的共享
  - 缺陷：实施过程花费时间长
- **带内共享**
  - 使用Telnet,SSH等连接方式通过网络传输密钥
  - 可以提高共享密钥的效率，但前提必须要保证传输密钥的通道绝对安全
- 解决方案
  - 通过非对称加密算法加密对称密钥算法的密钥
  - 然后在用对称加密算法加密实际要传输的数据

## 加密算法

- 通过非对称加密算法加密对称加密算法的密钥
- 然后在用对称加密算法加密实际要传输的数据

## IKE隧道建立

- 流量触发IPSec

- 建立管理连接----传输集

  ```java
  1.加密算法
  2.HMAC功能
  3.设备验证的类型
  4.DH密钥组
  5.管理连接的生存周期
  ```

- 配置安全策略

  crtpto isakmp policy  priority

  encryption {des|3des|aes}

  hash {sha|md5}

  authentication pre-share

  group {1|2|5}

  lifetme seconds

  指定预共享密钥

  crypto isakmp key {0明文|6} keystring address peer-address 子网掩码

- 建立数据连接

  1. 定义对等体间需要保护何种流量
  2. 定义用来保护数据的安全协议
  3. 定义连接模式
  4. 定义数据连接的生存周期以及密钥刷新的方式
  5. 安全关联的定义







































































































































































